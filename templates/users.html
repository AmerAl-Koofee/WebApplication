{% extends "base.html"%} 
{% block title %} Users {% endblock %} 
{% block content %} 
{% with messages = get_flashed_messages() %} 
{% if messages %} 
{% for message in messages %} 
{{ message }} 
{% endfor %} 
{% endif %} 
{% endwith %}

<div class="container">
  <div class="page">
    <div class="page_modify">
      <div class="a_tag_and_form">
        <div class="search-box">
          <form method="get">
            <input
              class="input"
              type="text"
              name="q"
              placeholder="Search..."
              value="{{ search_query }}"
            />
            <button class="search-button" type="submit">Search</button>
          </form>
        </div>
      </div>
      <table class="user_table">
        <thead class="th">
          <tr class="tr">
            <td class="td">
              Id
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='id', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='id', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Name
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Picture
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='id', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='id', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Email
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Phone
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Age
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Street Name
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Street Number
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Postcode
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              City
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              State
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
            <td class="td">
              Country
              <a
                href="{{ url_for('users', sort_order='asc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-up-arrow"></i>
              </a>
              <a
                href="{{ url_for('users', sort_order='desc', sort_column='name', q=search_query, page=current_page) }}"
              >
                <i class="bx bxs-down-arrow"></i>
              </a>
            </td>
          </tr>
        </thead>
        {% for user in users_list %}
        <tr class="tr">
          <td class="td_info">{{ user.id }}</td>

          <td class="td_info">
            <a href="{{ url_for('user_page', user_id = user.id) }} "
              >{{ user.name }}</a
            >
          </td>
          <td class="td_info">
            <a href="{{ url_for('user_page', user_id = user.id) }}"
              ><img
                src="{{ user.picture }}"
                alt="{{ user.name }}"
                class="users-page-pic"
            /></a>
          </td>
          <td class="td_info">{{ user.email }}</td>
          <td class="td_info">{{ user.phone }}</td>
          <td class="td_info">{{ user.age }}</td>
          <td class="td_info">{{ user.street_name }}</td>
          <td class="td_info">{{ user.street_number }}</td>
          <td class="td_info">{{ user.postcode }}</td>
          <td class="td_info">{{ user.city }}</td>
          <td class="td_info">{{ user.state }}</td>
          <td class="td_info">{{ user.country }}</td>
        </tr>
        {% endfor %}
      </table>
      <div class="nav">
        <nav>
          <ul class="pagination">
            {% if num_pages != 1 %} 
            {% if has_prev_page %}
            <li>
              <a
                class="page-link"
                href="{{ url_for('users', sort_column=sort_column, sort_order=sort_order, q=q, page=current_page - 1) }}"
              >
                <i class="bx bx-chevrons-left"></i>
              </a>
            </li>
            {% else %}
            <li>
              <a class="page-link"><i class="bx bx-chevrons-left"></i></a>
            </li>
            {% endif %} 
            {% for page_num in pagination.iter_pages(left_edge=0,
            right_edge=0, left_current=2, right_current=2) %} 
            {% if page_num %}
            {% if page_num != current_page %}
            <li>
              <a
                class="page-link"
                href="{{ url_for('users', sort_column=sort_column, sort_order=sort_order, q=q, page=page_num) }}"
                >{{ page_num }}</a
              >
            </li>
            {% else %}
            <li>
              <a class="page-link"><strong>{{ page_num }}</strong></a>
            </li>
            {% endif %} 
            {% endif %} 
            {% endfor %} 
            {% if has_next_page %}
            <li>
              <a
                class="page-link"
                href="{{ url_for('users', sort_column=sort_column, sort_order=sort_order, q=q, page=current_page + 1) }}"
              >
                <i class="bx bx-chevrons-right"></i>
              </a>
            </li>
            {% else %}
            <li>
              <a class="page-link"><i class="bx bx-chevrons-right"></i></a>
            </li>
            {% endif %} 
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>
{% endblock %}
